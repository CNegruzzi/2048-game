const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.board=t,this.score=0,this.status="idle"}moveLeft(){if("playing"!==this.status)return!1;let t=JSON.stringify(this.board),e=t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);return e};for(let t=0;t<4;t++){this.board[t]=e(this.board[t]);for(let e=0;e<3;e++)this.board[t][e]===this.board[t][e+1]&&(this.board[t][e]+=this.board[t][e+1],this.board[t][e+1]=0,this.score+=this.board[t][e],e++);this.board[t]=e(this.board[t])}return t!==JSON.stringify(this.board)}moveRight(){let t=JSON.stringify(this.board),e=t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.unshift(0);return e};for(let t=0;t<4;t++){this.board[t]=e(this.board[t]);for(let e=0;e<3;e++)this.board[t][e]===this.board[t][e+1]&&(this.board[t][e]+=this.board[t][e+1],this.board[t][e+1]=0,this.score+=this.board[t][e],e++);this.board[t]=e(this.board[t])}return t!==JSON.stringify(this.board)}moveUp(){let t=JSON.stringify(this.board),e=t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);return e};for(let t=0;t<4;t++){let s=[];for(let e=0;e<4;e++)s.push(this.board[e][t]);s=e(s);for(let t=0;t<3;t++)s[t]===s[t+1]&&(s[t]+=s[t+1],s[t+1]=0,this.score+=s[t],t++);s=e(s);for(let e=0;e<4;e++)this.board[e][t]=s[e]}return t!==JSON.stringify(this.board)}moveDown(){let t=JSON.stringify(this.board),e=t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);return e};for(let t=0;t<4;t++){let s=[];for(let e=0;e<4;e++)s.push(this.board[e][t]);s.reverse(),s=e(s);for(let t=0;t<3;t++)s[t]===s[t+1]&&(s[t]+=s[t+1],s[t+1]=0,this.score+=s[t],t++);(s=e(s)).reverse();for(let e=0;e<4;e++)this.board[e][t]=s[e]}return t!==JSON.stringify(this.board)}getScore(){return this.score}getState(){return this.board}getStatus(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(2048===this.board[t][e])return this.status="win",this.status;return!this.board.some(t=>t.includes(0))&&((t=>{for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(s<3&&t[e][s]===t[e][s+1]||e<3&&t[e][s]===t[e+1][s])return!0;return!1})(this.board)||(this.status="lose")),this.status}start(){"idle"===this.status&&(this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0),this.status="playing",this.addRandomTiles(),this.addRandomTiles()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}addRandomTiles(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,col:s});let e=t[Math.floor(Math.random()*t.length)];this.board[e.row][e.col]=.9>Math.random()?2:4}},e=document.querySelector(".game-score"),s=document.querySelector(".button.start"),r=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),i=document.querySelector(".message-start");function a(){let s=t.getState();document.querySelectorAll(".field-cell").forEach((t,e)=>{let r=s[Math.floor(e/4)][e%4];t.textContent=0===r?"":r,t.className="field-cell",r&&(t.classList.add(`field-cell--${r}`),(2===r||4===r)&&t.classList.add("new"))}),e.textContent=t.getScore();let a=t.getStatus();r.classList.toggle("hidden","win"!==a),o.classList.toggle("hidden","lose"!==a),i.classList.toggle("hidden","idle"!==a)}s.addEventListener("click",()=>{s.classList.contains("start")?(t.start(),a(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"):s.classList.contains("restart")&&(t.restart(),a(),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start")}),document.addEventListener("keydown",e=>{if("playing"!==t.getStatus())return;e.preventDefault();let s=!1,r=JSON.stringify(t.getState());switch(e.key){case"ArrowUp":s=t.moveUp();break;case"ArrowDown":s=t.moveDown();break;case"ArrowLeft":s=t.moveLeft();break;case"ArrowRight":s=t.moveRight()}let o=JSON.stringify(t.getState());s&&r!==o&&(t.addRandomTiles(),a())}),a();
//# sourceMappingURL=2048-game.39281adc.js.map
